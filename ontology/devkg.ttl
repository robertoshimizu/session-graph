@prefix rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:     <http://www.w3.org/2002/07/owl#> .
@prefix xsd:     <http://www.w3.org/2001/XMLSchema#> .
@prefix prov:    <http://www.w3.org/ns/prov#> .
@prefix sioc:    <http://rdfs.org/sioc/ns#> .
@prefix skos:    <http://www.w3.org/2004/02/skos/core#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema:  <http://schema.org/> .
@prefix devkg:   <http://devkg.local/ontology#> .

# =============================================================================
# Ontology Declaration
# =============================================================================

<http://devkg.local/ontology> a owl:Ontology ;
    dcterms:title "Dev Knowledge Graph Ontology"@en ;
    dcterms:description "A minimal OWL ontology composing PROV-O, SIOC, SKOS, Dublin Core, and Schema.org for developer knowledge graphs."@en ;
    dcterms:created "2026-02-13"^^xsd:date ;
    owl:imports <http://www.w3.org/ns/prov-o#> ;
    rdfs:comment "Composes W3C standards to model developer sessions, conversations, code artifacts, and knowledge topics."@en .

# =============================================================================
# Classes
# =============================================================================

# --- Session: a developer working session (e.g., a Claude Code conversation) ---
devkg:Session a owl:Class ;
    rdfs:subClassOf prov:Activity, sioc:Forum ;
    rdfs:label "Session"@en ;
    rdfs:comment "A developer working session spanning one or more messages. Models both the provenance activity and the conversation container."@en .

# --- Message: a single message in a session ---
devkg:Message a owl:Class ;
    rdfs:subClassOf sioc:Post, prov:Entity ;
    rdfs:label "Message"@en ;
    rdfs:comment "A message within a session. Inherits SIOC post structure and PROV entity provenance."@en .

devkg:UserMessage a owl:Class ;
    rdfs:subClassOf devkg:Message ;
    rdfs:label "User Message"@en ;
    rdfs:comment "A message authored by the human developer."@en .

devkg:AssistantMessage a owl:Class ;
    rdfs:subClassOf devkg:Message ;
    rdfs:label "Assistant Message"@en ;
    rdfs:comment "A message generated by an AI assistant."@en .

# --- Tool interactions ---
devkg:ToolCall a owl:Class ;
    rdfs:subClassOf prov:Activity ;
    rdfs:label "Tool Call"@en ;
    rdfs:comment "An invocation of a tool (Bash, Read, Write, etc.) during a session. A sub-activity of the session."@en .

devkg:ToolResult a owl:Class ;
    rdfs:subClassOf prov:Entity ;
    rdfs:label "Tool Result"@en ;
    rdfs:comment "The output/result produced by a tool call."@en .

# --- Code artifacts ---
devkg:CodeArtifact a owl:Class ;
    rdfs:subClassOf prov:Entity, schema:SoftwareSourceCode ;
    rdfs:label "Code Artifact"@en ;
    rdfs:comment "A code file or snippet produced or referenced during a session."@en .

# --- Agents ---
devkg:Developer a owl:Class ;
    rdfs:subClassOf prov:Agent ;
    rdfs:label "Developer"@en ;
    rdfs:comment "A human developer who participates in sessions."@en .

devkg:AIModel a owl:Class ;
    rdfs:subClassOf prov:Agent ;
    rdfs:label "AI Model"@en ;
    rdfs:comment "An AI model (e.g., Claude, GPT, Gemini) that participates in sessions."@en .

# --- Topics ---
devkg:Topic a owl:Class ;
    rdfs:subClassOf skos:Concept ;
    rdfs:label "Topic"@en ;
    rdfs:comment "A developer knowledge topic, organized via SKOS taxonomy."@en .

# =============================================================================
# Object Properties
# =============================================================================

devkg:hasParentMessage a owl:ObjectProperty ;
    rdfs:subPropertyOf sioc:reply_of ;
    rdfs:label "has parent message"@en ;
    rdfs:comment "Links a message to the message it replies to within a session."@en ;
    rdfs:domain devkg:Message ;
    rdfs:range devkg:Message .

devkg:usedInSession a owl:ObjectProperty ;
    rdfs:label "used in session"@en ;
    rdfs:comment "Links a message, tool call, or artifact to the session it belongs to."@en ;
    rdfs:range devkg:Session .

devkg:mentionsTopic a owl:ObjectProperty ;
    rdfs:label "mentions topic"@en ;
    rdfs:comment "Links a message or artifact to a SKOS concept/topic it discusses."@en ;
    rdfs:range devkg:Topic .

devkg:producedArtifact a owl:ObjectProperty ;
    rdfs:subPropertyOf prov:generated ;
    rdfs:label "produced artifact"@en ;
    rdfs:comment "Links a session or tool call to a code artifact it produced."@en ;
    rdfs:domain prov:Activity ;
    rdfs:range devkg:CodeArtifact .

devkg:invokedTool a owl:ObjectProperty ;
    rdfs:label "invoked tool"@en ;
    rdfs:comment "Links an assistant message to the tool call it triggered."@en ;
    rdfs:domain devkg:AssistantMessage ;
    rdfs:range devkg:ToolCall .

devkg:hasToolResult a owl:ObjectProperty ;
    rdfs:subPropertyOf prov:generated ;
    rdfs:label "has tool result"@en ;
    rdfs:comment "Links a tool call to its result."@en ;
    rdfs:domain devkg:ToolCall ;
    rdfs:range devkg:ToolResult .

# =============================================================================
# Datatype Properties
# =============================================================================

devkg:hasMessageId a owl:DatatypeProperty ;
    rdfs:label "has message ID"@en ;
    rdfs:comment "The unique identifier (UUID) of a message."@en ;
    rdfs:domain devkg:Message ;
    rdfs:range xsd:string .

devkg:hasToolName a owl:DatatypeProperty ;
    rdfs:label "has tool name"@en ;
    rdfs:comment "The name of the tool invoked (e.g., Bash, Read, Write, Grep)."@en ;
    rdfs:domain devkg:ToolCall ;
    rdfs:range xsd:string .

devkg:hasModel a owl:DatatypeProperty ;
    rdfs:label "has model"@en ;
    rdfs:comment "The AI model identifier used (e.g., claude-opus-4-6, gpt-4o)."@en ;
    rdfs:domain devkg:AIModel ;
    rdfs:range xsd:string .

devkg:hasFilePath a owl:DatatypeProperty ;
    rdfs:label "has file path"@en ;
    rdfs:comment "The file system path of a code artifact."@en ;
    rdfs:domain devkg:CodeArtifact ;
    rdfs:range xsd:string .

devkg:hasSourcePlatform a owl:DatatypeProperty ;
    rdfs:label "has source platform"@en ;
    rdfs:comment "The platform a session originated from (e.g., claude-code, chatgpt, cursor, vscode-copilot)."@en ;
    rdfs:domain devkg:Session ;
    rdfs:range xsd:string .

devkg:hasWorkingDirectory a owl:DatatypeProperty ;
    rdfs:label "has working directory"@en ;
    rdfs:comment "The filesystem working directory at the time of a message or tool call."@en ;
    rdfs:range xsd:string .

# =============================================================================
# SKOS Concept Scheme and Example Concepts
# =============================================================================

devkg:DevKnowledgeScheme a skos:ConceptScheme ;
    dcterms:title "Developer Knowledge Topics"@en ;
    dcterms:description "Taxonomy of topics encountered in developer sessions."@en .

devkg:concept-programming a devkg:Topic ;
    skos:prefLabel "Programming"@en ;
    skos:inScheme devkg:DevKnowledgeScheme ;
    skos:topConceptOf devkg:DevKnowledgeScheme .

devkg:concept-web-development a devkg:Topic ;
    skos:prefLabel "Web Development"@en ;
    skos:inScheme devkg:DevKnowledgeScheme ;
    skos:broader devkg:concept-programming .

devkg:concept-authentication a devkg:Topic ;
    skos:prefLabel "Authentication"@en ;
    skos:inScheme devkg:DevKnowledgeScheme ;
    skos:broader devkg:concept-web-development ;
    skos:related devkg:concept-database .

devkg:concept-database a devkg:Topic ;
    skos:prefLabel "Database"@en ;
    skos:inScheme devkg:DevKnowledgeScheme ;
    skos:broader devkg:concept-programming .

devkg:concept-ai-ml a devkg:Topic ;
    skos:prefLabel "AI and Machine Learning"@en ;
    skos:altLabel "AI/ML"@en ;
    skos:inScheme devkg:DevKnowledgeScheme ;
    skos:topConceptOf devkg:DevKnowledgeScheme .

devkg:DevKnowledgeScheme skos:hasTopConcept
    devkg:concept-programming ,
    devkg:concept-ai-ml .

# =============================================================================
# Extended Classes for Knowledge Triple Extraction
# =============================================================================

# --- Entity: an extracted technical concept/entity from conversations ---
devkg:Entity a owl:Class ;
    rdfs:subClassOf prov:Entity ;
    rdfs:label "Entity"@en ;
    rdfs:comment "An extracted technical concept or entity from conversations. Represents a named thing (technology, pattern, tool, platform, etc.) that participates in knowledge relationships."@en .

# --- KnowledgeTriple: a reified triple for provenance tracking ---
devkg:KnowledgeTriple a owl:Class ;
    rdfs:label "Knowledge Triple"@en ;
    rdfs:comment "A reified knowledge triple node for provenance tracking. Links a subject entity to an object entity via a predicate label, and records the source message and session from which the triple was extracted."@en .

# =============================================================================
# Curated Predicate Vocabulary for Knowledge Triple Extraction
# =============================================================================

devkg:uses a owl:ObjectProperty ;
    rdfs:label "uses"@en ;
    rdfs:comment "X uses technology, tool, or library Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:dependsOn a owl:ObjectProperty ;
    rdfs:label "depends on"@en ;
    rdfs:comment "X depends on Y (runtime, build, or logical dependency)."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:enables a owl:ObjectProperty ;
    rdfs:label "enables"@en ;
    rdfs:comment "X enables capability or feature Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:isPartOf a owl:ObjectProperty ;
    rdfs:subPropertyOf dcterms:isPartOf ;
    rdfs:label "is part of"@en ;
    rdfs:comment "X is a component or part of larger system Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:hasPart a owl:ObjectProperty ;
    rdfs:subPropertyOf dcterms:hasPart ;
    rdfs:label "has part"@en ;
    rdfs:comment "X has component or sub-part Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:implements a owl:ObjectProperty ;
    rdfs:label "implements"@en ;
    rdfs:comment "X implements pattern, specification, or interface Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:extends a owl:ObjectProperty ;
    rdfs:label "extends"@en ;
    rdfs:comment "X extends or specializes Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:alternativeTo a owl:ObjectProperty ;
    rdfs:label "alternative to"@en ;
    rdfs:comment "X is an alternative or substitute for Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:solves a owl:ObjectProperty ;
    rdfs:label "solves"@en ;
    rdfs:comment "X solves problem or addresses challenge Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:produces a owl:ObjectProperty ;
    rdfs:label "produces"@en ;
    rdfs:comment "X produces output or artifact Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:configures a owl:ObjectProperty ;
    rdfs:label "configures"@en ;
    rdfs:comment "X configures or parametrizes Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:composesWith a owl:ObjectProperty ;
    rdfs:label "composes with"@en ;
    rdfs:comment "X composes or combines with Y to form a larger system."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:provides a owl:ObjectProperty ;
    rdfs:label "provides"@en ;
    rdfs:comment "X provides capability, service, or feature Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:requires a owl:ObjectProperty ;
    rdfs:label "requires"@en ;
    rdfs:comment "X requires prerequisite or dependency Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:isTypeOf a owl:ObjectProperty ;
    rdfs:label "is type of"@en ;
    rdfs:comment "X is a type or kind of Y (taxonomic relationship)."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:builtWith a owl:ObjectProperty ;
    rdfs:label "built with"@en ;
    rdfs:comment "X is built with technology, framework, or language Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:deployedOn a owl:ObjectProperty ;
    rdfs:label "deployed on"@en ;
    rdfs:comment "X is deployed on platform or infrastructure Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:storesIn a owl:ObjectProperty ;
    rdfs:label "stores in"@en ;
    rdfs:comment "X stores data in database or storage system Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:queriedWith a owl:ObjectProperty ;
    rdfs:label "queried with"@en ;
    rdfs:comment "X is queried using language or tool Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:integratesWith a owl:ObjectProperty ;
    rdfs:label "integrates with"@en ;
    rdfs:comment "X integrates with external system or service Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:broader a owl:ObjectProperty ;
    rdfs:subPropertyOf skos:broader ;
    rdfs:label "broader"@en ;
    rdfs:comment "X is a broader concept than Y (generalization)."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:narrower a owl:ObjectProperty ;
    rdfs:subPropertyOf skos:narrower ;
    rdfs:label "narrower"@en ;
    rdfs:comment "X is a narrower concept than Y (specialization)."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:relatedTo a owl:ObjectProperty ;
    rdfs:subPropertyOf skos:related ;
    rdfs:label "related to"@en ;
    rdfs:comment "X is related to Y (generic fallback when no specific predicate fits)."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

devkg:servesAs a owl:ObjectProperty ;
    rdfs:label "serves as"@en ;
    rdfs:comment "X serves as or acts in the role of Y."@en ;
    rdfs:domain devkg:Entity ;
    rdfs:range devkg:Entity .

# =============================================================================
# Reification Properties for KnowledgeTriple
# =============================================================================

devkg:tripleSubject a owl:ObjectProperty ;
    rdfs:label "triple subject"@en ;
    rdfs:comment "The subject entity of the extracted knowledge triple."@en ;
    rdfs:domain devkg:KnowledgeTriple ;
    rdfs:range devkg:Entity .

devkg:tripleObject a owl:ObjectProperty ;
    rdfs:label "triple object"@en ;
    rdfs:comment "The object entity of the extracted knowledge triple."@en ;
    rdfs:domain devkg:KnowledgeTriple ;
    rdfs:range devkg:Entity .

devkg:triplePredicateLabel a owl:DatatypeProperty ;
    rdfs:label "triple predicate label"@en ;
    rdfs:comment "The predicate name of the extracted knowledge triple (e.g., 'uses', 'dependsOn')."@en ;
    rdfs:domain devkg:KnowledgeTriple ;
    rdfs:range xsd:string .

devkg:extractedFrom a owl:ObjectProperty ;
    rdfs:label "extracted from"@en ;
    rdfs:comment "Links a knowledge triple to the source message from which it was extracted."@en ;
    rdfs:domain devkg:KnowledgeTriple ;
    rdfs:range devkg:Message .

devkg:extractedInSession a owl:ObjectProperty ;
    rdfs:label "extracted in session"@en ;
    rdfs:comment "Links a knowledge triple to the session in which it was extracted."@en ;
    rdfs:domain devkg:KnowledgeTriple ;
    rdfs:range devkg:Session .

# =============================================================================
# Sprint 3: Project and Source Tracking
# =============================================================================

# --- Project: a development project spanning multiple sessions ---
devkg:Project a owl:Class ;
    rdfs:subClassOf prov:Entity ;
    rdfs:label "Project"@en ;
    rdfs:comment "A development project spanning multiple sessions."@en .

devkg:hasSourceFile a owl:DatatypeProperty ;
    rdfs:label "has source file"@en ;
    rdfs:comment "Filesystem path or URI of the raw source data."@en ;
    rdfs:range xsd:string .

devkg:belongsToProject a owl:ObjectProperty ;
    rdfs:label "belongs to project"@en ;
    rdfs:comment "Links a session to the project it belongs to."@en ;
    rdfs:domain devkg:Session ;
    rdfs:range devkg:Project .
